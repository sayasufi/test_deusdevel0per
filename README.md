
# Бот для обмена валют

Этот проект представляет собой Telegram-бота для отображения актуальных курсов валют и конвертации валют на основе курсов Центрального банка России.

## Возможности

- Получение курсов валют от Центрального банка России и сохранение их в Redis.
- Конвертация сумм валют с использованием сохраненных курсов.
- Отображение текущих курсов валют.
- Интерактивное меню с кнопками для конвертации валют и отображения курсов валют.
- Поддержка команд:
  - `/start` - Запуск бота и отображение интерактивного меню.
  - `/help` - Показать справочную информацию.
  - `/exchange <from_currency> <to_currency> <amount>` - Конвертация указанной суммы из одной валюты в другую.
  - `/rates` - Показать текущие курсы валют.

## Требования

- Python 3.12
- Docker
- Docker Compose
- Токен Telegram-бота

## Настройка

1. Клонируйте репозиторий:

   ```bash
   git clone <repository_url>
   cd <repository_directory>
   ```

2. Создайте файл `.env` с вашим токеном Telegram-бота:

   ```env
   TELEGRAM_TOKEN=YOUR_TELEGRAM_BOT_TOKEN
   ```

3. Соберите и запустите Docker-контейнеры:

   ```bash
   docker-compose up --build
   ```

## Структура проекта

- `bot.py` - Основной файл для Telegram-бота.
- `currency_service.py` - Сервис для получения и хранения курсов валют.
- `config.py` - Конфигурационный файл для переменных окружения.
- `Dockerfile` - Dockerfile для сборки образа бота.
- `docker-compose.yml` - Файл Docker Compose для настройки бота и Redis.

## Использование

### Запуск бота

Используйте команду `/start` для запуска бота и отображения интерактивного меню. Меню включает опции для конвертации валют и отображения курсов валют.

### Справка

Используйте команду `/help` для отображения информации о том, как использовать бота и его команды.

### Конвертация валют

Используйте команду `/exchange <from_currency> <to_currency> <amount>` для конвертации указанной суммы из одной валюты в другую. Например:

```bash
/exchange USD RUB 10
```

Эта команда конвертирует 10 долларов США в рубли на основе текущего курса.

### Показ курсов валют

Используйте команду `/rates` для отображения текущих курсов валют.

## Подробности реализации

### `bot.py`

- Инициализирует Telegram-бота и диспетчер.
- Определяет состояния для конвертации валют с использованием FSM `aiogram`.
- Обеспечивает обработчики для команд (`/start`, `/help`, `/exchange`, `/rates`).
- Обеспечивает обработчики callback query для опций интерактивного меню.
- Настраивает меню команд бота.

### `currency_service.py`

- Получает курсы валют от Центрального банка России.
- Парсит XML-ответ и сохраняет курсы валют в Redis.
- Планирует ежедневное обновление курсов валют в полночь.

### `config.py`

- Содержит конфигурации переменных окружения для Redis и токена Telegram-бота.

### `Dockerfile`

- Собирает Docker-образ для бота.

### `docker-compose.yml`

- Настраивает и запускает Docker-контейнеры для бота и Redis.

## Обработка ошибок

- Если бот не может получить или распарсить курсы валют, он логирует ошибку и вызывает исключение.
- Если бот не может найти указанные курсы валют в Redis, он уведомляет пользователя об ошибке.
